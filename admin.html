<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Admin - HDV</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f3f4f6; }
        .header { background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); color: white; padding: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 100; }
        .header h1 { font-size: 24px; margin-bottom: 5px; }
        
        /* Tabs principales */
        .main-tabs { background: white; border-bottom: 2px solid #e5e7eb; padding: 0 20px; display: flex; gap: 5px; overflow-x: auto; }
        .main-tab { padding: 15px 24px; background: none; border: none; font-size: 15px; font-weight: 600; color: #6b7280; cursor: pointer; border-bottom: 3px solid transparent; white-space: nowrap; }
        .main-tab.active { color: #2563eb; border-bottom-color: #2563eb; }
        .main-tab:hover { color: #2563eb; background: #f9fafb; }
        
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .card { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .card h2 { font-size: 18px; margin-bottom: 15px; color: #111827; }
        
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .stat-label { font-size: 14px; color: #6b7280; margin-bottom: 5px; }
        .stat-value { font-size: 32px; font-weight: 700; color: #111827; }
        .stat-value.money { color: #2563eb; }
        
        .btn { padding: 12px 24px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-primary { background: #2563eb; color: white; }
        .btn-primary:hover { background: #1d4ed8; }
        .btn-success { background: #10b981; color: white; }
        .btn-danger { background: #ef4444; color: white; }
        .btn-secondary { background: #e5e7eb; color: #374151; }
        
        .filters { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .filter-group label { display: block; font-size: 14px; font-weight: 600; color: #374151; margin-bottom: 5px; }
        .filter-group select, .filter-group input { width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 14px; }
        
        .tabla { width: 100%; border-collapse: collapse; }
        .tabla th { background: #f3f4f6; padding: 12px; text-align: left; font-size: 14px; font-weight: 600; color: #374151; position: sticky; top: 0; }
        .tabla td { padding: 12px; border-bottom: 1px solid #e5e7eb; font-size: 14px; }
        .tabla tr:hover { background: #f9fafb; }
        .tabla input, .tabla select { width: 100%; padding: 8px; border: 2px solid #e5e7eb; border-radius: 6px; font-size: 14px; }
        
        .pedido-card { border-bottom: 1px solid #e5e7eb; padding: 20px; }
        .pedido-card:hover { background: #f9fafb; }
        .pedido-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px; flex-wrap: wrap; gap: 10px; }
        .pedido-status { padding: 6px 12px; border-radius: 20px; font-size: 12px; font-weight: 600; }
        .status-pendiente { background: #fef3c7; color: #92400e; }
        .status-entregado { background: #d1fae5; color: #065f46; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; }
        .modal.show { display: flex; }
        .modal-content { background: white; border-radius: 16px; padding: 24px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; }
        .modal-header { font-size: 20px; font-weight: 700; margin-bottom: 20px; }
        .modal-actions { display: flex; gap: 10px; margin-top: 20px; }
        
        .success { background: #d1fae5; color: #065f46; padding: 12px; border-radius: 8px; margin-bottom: 20px; text-align: center; display: none; }
        .empty-state { text-align: center; padding: 60px 20px; color: #6b7280; }
        .loading { text-align: center; padding: 40px; }
        .spinner { border: 3px solid #f3f4f6; border-top: 3px solid #2563eb; border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        @media (max-width: 768px) {
            .pedido-header { flex-direction: column; }
            .filters { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üéØ Panel de Administraci√≥n</h1>
        <div class="subtitle">HDV Distribuciones</div>
    </div>

    <!-- Tabs Principales -->
    <div class="main-tabs">
        <button class="main-tab active" onclick="cambiarSeccion('pedidos')">üì¶ Pedidos</button>
        <button class="main-tab" onclick="cambiarSeccion('creditos')">üí≥ Cr√©ditos</button>
        <button class="main-tab" onclick="cambiarSeccion('stock')">üìä Stock/Inventario</button>
        <button class="main-tab" onclick="cambiarSeccion('reportes')">üìà Reportes</button>
        <button class="main-tab" onclick="cambiarSeccion('precios')">üí∞ Precios por Cliente</button>
        <button class="main-tab" onclick="cambiarSeccion('productos')">üè∑Ô∏è Gestionar Productos</button>
        <button class="main-tab" onclick="cambiarSeccion('clientes')">üë• Gestionar Clientes</button>
    </div>

    <div class="container">
        <!-- SECCI√ìN: PEDIDOS -->
        <div id="seccion-pedidos" class="tab-content active">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-label">Total Pedidos Hoy</div>
                    <div class="stat-value" id="totalPedidos">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Pendientes</div>
                    <div class="stat-value" id="pedidosPendientes">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Entregados</div>
                    <div class="stat-value" id="pedidosEntregados">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Gs.</div>
                    <div class="stat-value money" id="totalGuaranies">0</div>
                </div>
            </div>

            <div class="card">
                <div class="filters">
                    <div class="filter-group">
                        <label>Fecha</label>
                        <input type="date" id="filterFecha" />
                    </div>
                    <div class="filter-group">
                        <label>Cliente</label>
                        <select id="filterCliente"><option value="">Todos</option></select>
                    </div>
                    <div class="filter-group">
                        <label>Zona</label>
                        <select id="filterZona"><option value="">Todas</option></select>
                    </div>
                    <div class="filter-group">
                        <label>Estado</label>
                        <select id="filterEstado">
                            <option value="">Todos</option>
                            <option value="pendiente">Pendiente</option>
                            <option value="entregado">Entregado</option>
                        </select>
                    </div>
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="aplicarFiltrosPedidos()">Aplicar Filtros</button>
                    <button class="btn btn-secondary" onclick="limpiarFiltrosPedidos()">Limpiar</button>
                    <button class="btn btn-secondary" onclick="exportarPedidosExcel()" style="margin-left: auto;">üìä Exportar Excel</button>
                </div>
            </div>

            <div class="card" id="pedidosList">
                <div class="loading"><div class="spinner"></div><p style="margin-top: 15px;">Cargando pedidos...</p></div>
            </div>
        </div>

        <!-- SECCI√ìN: CR√âDITOS -->
        <div id="seccion-creditos" class="tab-content">
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-label">Total Cr√©ditos Pendientes</div>
                    <div class="stat-value money" id="totalCreditosPendientes">Gs. 0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Cantidad de Cr√©ditos</div>
                    <div class="stat-value" id="cantidadCreditos">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Clientes con Cr√©dito</div>
                    <div class="stat-value" id="clientesConCredito">0</div>
                </div>
            </div>

            <div class="card">
                <div class="filters">
                    <div class="filter-group">
                        <label>Cliente</label>
                        <select id="filterClienteCredito"><option value="">Todos</option></select>
                    </div>
                    <div class="filter-group">
                        <label>Estado</label>
                        <select id="filterEstadoCredito">
                            <option value="pendiente_pago">Pendiente Pago</option>
                            <option value="pagado">Pagado</option>
                            <option value="todos">Todos</option>
                        </select>
                    </div>
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="aplicarFiltrosCreditos()">Aplicar Filtros</button>
                    <button class="btn btn-secondary" onclick="exportarCreditosExcel()" style="margin-left: auto;">üìä Exportar Excel</button>
                </div>
            </div>

            <div class="card" id="creditosList">
                <div class="loading"><div class="spinner"></div><p style="margin-top: 15px;">Cargando cr√©ditos...</p></div>
            </div>
        </div>

        <!-- SECCI√ìN: STOCK/INVENTARIO -->
        <div id="seccion-stock" class="tab-content">
            <div class="success" id="successStock">‚úì Stock actualizado</div>
            
            <div class="card">
                <div style="display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;align-items:center;">
                    <h2 style="margin:0;flex:1;">Control de Inventario</h2>
                    <button class="btn btn-success" onclick="guardarStock()">üíæ Guardar Stock</button>
                    <button class="btn btn-secondary" onclick="exportarStockExcel()">üìä Exportar Excel</button>
                </div>
                <div style="margin-bottom:15px;">
                    <input type="text" id="buscarStock" placeholder="üîç Buscar productos..." oninput="filtrarStock()" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                </div>
            </div>

            <div class="card">
                <div style="overflow-x:auto;">
                    <table class="tabla">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Presentaci√≥n</th>
                                <th>Stock Actual</th>
                                <th>Stock M√≠nimo</th>
                                <th>Estado</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="stockBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- SECCI√ìN: REPORTES -->
        <div id="seccion-reportes" class="tab-content">
            <div class="card">
                <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="tipoReporte='zona';generarReporte()">Por Zona</button>
                    <button class="btn btn-primary" onclick="tipoReporte='vendedor';generarReporte()">Por Vendedor</button>
                    <button class="btn btn-primary" onclick="tipoReporte='producto';generarReporte()">Por Producto</button>
                    <button class="btn btn-primary" onclick="tipoReporte='cliente';generarReporte()">Por Cliente</button>
                </div>
                <div class="filters">
                    <div class="filter-group">
                        <label>Desde:</label>
                        <input type="date" id="reporteFechaDesde">
                    </div>
                    <div class="filter-group">
                        <label>Hasta:</label>
                        <input type="date" id="reporteFechaHasta">
                    </div>
                </div>
            </div>

            <div class="card" id="statsReporte" style="display:none;">
                <h2>Resumen General</h2>
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-label">Total Ventas</div>
                        <div class="stat-value money" id="rTotalVentas">Gs. 0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Total Pedidos</div>
                        <div class="stat-value" id="rTotalPedidos">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Ticket Promedio</div>
                        <div class="stat-value money" id="rTicketPromedio">Gs. 0</div>
                    </div>
                </div>
            </div>
            
            <!-- Gr√°fico -->
            <div class="card" id="graficoReporte" style="display:none;">
                <h2>Visualizaci√≥n</h2>
                <canvas id="chartReporte" style="max-height: 400px;"></canvas>
            </div>

            <div class="card" id="resultadosReporte" style="display:none;">
                <div style="display:flex;justify-content:space-between;margin-bottom:15px;flex-wrap:wrap;gap:10px;">
                    <h2 id="tituloReporte">Reporte</h2>
                    <button class="btn btn-primary" onclick="exportarReporteExcel()">üì• Exportar</button>
                </div>
                <div style="overflow-x:auto;">
                    <table class="tabla" id="tablaReporte">
                        <thead id="reporteHeader"></thead>
                        <tbody id="reporteBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- SECCI√ìN: PRECIOS POR CLIENTE -->
        <div id="seccion-precios" class="tab-content">
            <div class="success" id="successPrecios">‚úì Precios guardados</div>
            <div class="card">
                <h2>Configurar Precios Personalizados</h2>
                <div class="filter-group" style="max-width: 400px;">
                    <label>Seleccionar Cliente:</label>
                    <select id="preciosCliente" onchange="cargarPreciosCliente()">
                        <option value="">-- Seleccione --</option>
                    </select>
                </div>
            </div>

            <div class="card" id="preciosCard" style="display:none;">
                <div style="margin-bottom: 15px;">
                    <input type="text" id="buscarProductoPrecio" placeholder="üîç Buscar producto..." style="width: 100%; padding: 10px; border: 2px solid #e5e7eb; border-radius: 8px;">
                </div>
                <div style="overflow-x:auto;">
                    <table class="tabla">
                        <thead>
                            <tr>
                                <th>Producto</th>
                                <th>Presentaci√≥n</th>
                                <th>Precio Base</th>
                                <th>Precio Personalizado</th>
                            </tr>
                        </thead>
                        <tbody id="preciosBody"></tbody>
                    </table>
                </div>
                <div style="margin-top: 20px;">
                    <button class="btn btn-success" onclick="guardarPreciosPersonalizados()">üíæ Guardar y Descargar</button>
                </div>
            </div>
        </div>

        <!-- SECCI√ìN: GESTIONAR PRODUCTOS -->
        <div id="seccion-productos" class="tab-content">
            <div class="success" id="successProductos">‚úì Productos guardados</div>
            <div class="card">
                <div style="display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;">
                    <button class="btn btn-primary" onclick="mostrarModalNuevoProducto()">+ Nuevo Producto</button>
                    <button class="btn btn-success" onclick="guardarProductos()">üíæ Guardar y Descargar</button>
                    <div style="flex:1;min-width:250px;">
                        <input type="text" id="buscarProducto" placeholder="üîç Buscar productos..." oninput="filtrarProductos()" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                    </div>
                </div>
            </div>

            <div class="card">
                <div style="overflow-x:auto;">
                    <table class="tabla">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Producto</th>
                                <th>Categor√≠a</th>
                                <th>Subcategor√≠a</th>
                                <th>Presentaciones</th>
                                <th style="width:80px;">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="productosBody"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- SECCI√ìN: GESTIONAR CLIENTES -->
        <div id="seccion-clientes" class="tab-content">
            <div class="success" id="successClientes">‚úì Clientes guardados</div>
            <div class="card">
                <div style="display:flex;gap:10px;margin-bottom:20px;flex-wrap:wrap;">
                    <button class="btn btn-primary" onclick="mostrarModalNuevoCliente()">+ Nuevo Cliente</button>
                    <button class="btn btn-success" onclick="guardarClientes()">üíæ Guardar y Descargar</button>
                    <div style="flex:1;min-width:250px;">
                        <input type="text" id="buscarCliente" placeholder="üîç Buscar clientes..." oninput="filtrarClientes()" style="width: 100%; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px;">
                    </div>
                </div>
            </div>

            <div class="card">
                <div style="overflow-x:auto;">
                    <table class="tabla">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nombre</th>
                                <th>Zona</th>
                                <th>Precios Personalizados</th>
                                <th style="width:80px;">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="clientesBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Nuevo Producto -->
    <div class="modal" id="modalNuevoProducto">
        <div class="modal-content">
            <div class="modal-header">Nuevo Producto</div>
            <div class="filter-group">
                <label>Nombre:</label>
                <input type="text" id="nuevoNombre" placeholder="Ej: Jab√≥n Dove">
            </div>
            <div class="filter-group">
                <label>Categor√≠a:</label>
                <select id="nuevoCategoria"></select>
            </div>
            <div class="filter-group">
                <label>Subcategor√≠a:</label>
                <input type="text" id="nuevoSubcategoria" placeholder="Ej: Jabones">
            </div>
            <div class="filter-group">
                <label>Presentaciones (separadas por coma):</label>
                <input type="text" id="nuevoPresentaciones" placeholder="Ej: 125g, 90g">
            </div>
            <div class="filter-group">
                <label>Precio Base:</label>
                <input type="number" id="nuevoPrecio" placeholder="1000">
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="cerrarModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="agregarNuevoProducto()">Agregar</button>
            </div>
        </div>
    </div>

    <!-- Modal Nuevo Cliente -->
    <div class="modal" id="modalNuevoCliente">
        <div class="modal-content">
            <div class="modal-header">Nuevo Cliente</div>
            <div class="filter-group">
                <label>Nombre del Cliente:</label>
                <input type="text" id="nuevoClienteNombre" placeholder="Ej: Supermercado Central">
            </div>
            <div class="filter-group">
                <label>Zona:</label>
                <input type="text" id="nuevoClienteZona" placeholder="Ej: Loma Plata">
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="cerrarModalCliente()">Cancelar</button>
                <button class="btn btn-primary" onclick="agregarNuevoCliente()">Agregar</button>
            </div>
        </div>
    </div>

    <script src="admin.js"></script>
</body>
</html>
